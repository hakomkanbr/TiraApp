{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Abdulhekim abdullah\\\\Desktop\\\\News project\\\\backend\\\\NSiteApi\\\\nextClient\\\\store\\\\GlobalState.js\";\nimport { createContext, useReducer, useEffect } from 'react';\nimport reducers from './Reducers';\nimport { getData } from '../utils/fetchData';\nexport const DataContext = /*#__PURE__*/createContext();\nexport const DataProvider = ({\n  children\n}) => {\n  const initialState = {\n    notify: {},\n    auth: {},\n    cart: [],\n    modal: [],\n    orders: [],\n    users: [],\n    categories: []\n  };\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(reducers, initialState);\n  const {\n    cart,\n    auth\n  } = state;\n  useEffect(() => {\n    const firstLogin = localStorage.getItem(\"firstLogin\");\n\n    if (firstLogin) {\n      getData('auth/accessToken').then(res => {\n        if (res.err) return localStorage.removeItem(\"firstLogin\");\n        dispatch({\n          type: \"AUTH\",\n          payload: {\n            token: res.access_token,\n            user: res.user\n          }\n        });\n      });\n    }\n\n    getData('categories').then(res => {\n      if (res.err) return dispatch({\n        type: 'NOTIFY',\n        payload: {\n          error: res.err\n        }\n      });\n      dispatch({\n        type: \"ADD_CATEGORIES\",\n        payload: res.categories\n      });\n    });\n  }, []);\n  useEffect(() => {\n    const __next__cart01__devat = JSON.parse(localStorage.getItem('__next__cart01__devat'));\n\n    if (__next__cart01__devat) dispatch({\n      type: 'ADD_CART',\n      payload: __next__cart01__devat\n    });\n  }, []);\n  useEffect(() => {\n    localStorage.setItem('__next__cart01__devat', JSON.stringify(cart));\n  }, [cart]);\n  useEffect(() => {\n    if (auth.token) {\n      getData('order', auth.token).then(res => {\n        if (res.err) return dispatch({\n          type: 'NOTIFY',\n          payload: {\n            error: res.err\n          }\n        });\n        dispatch({\n          type: 'ADD_ORDERS',\n          payload: res.orders\n        });\n      });\n\n      if (auth.user.role === 'admin') {\n        getData('user', auth.token).then(res => {\n          if (res.err) return dispatch({\n            type: 'NOTIFY',\n            payload: {\n              error: res.err\n            }\n          });\n          dispatch({\n            type: 'ADD_USERS',\n            payload: res.users\n          });\n        });\n      }\n    } else {\n      dispatch({\n        type: 'ADD_ORDERS',\n        payload: []\n      });\n      dispatch({\n        type: 'ADD_USERS',\n        payload: []\n      });\n    }\n  }, [auth.token]);\n  return /*#__PURE__*/_jsxDEV(DataContext.Provider, {\n    value: {\n      state,\n      dispatch\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 9\n  }, this);\n};","map":{"version":3,"sources":["C:/Users/Abdulhekim abdullah/Desktop/News project/backend/NSiteApi/nextClient/store/GlobalState.js"],"names":["createContext","useReducer","useEffect","reducers","getData","DataContext","DataProvider","children","initialState","notify","auth","cart","modal","orders","users","categories","state","dispatch","firstLogin","localStorage","getItem","then","res","err","removeItem","type","payload","token","access_token","user","error","__next__cart01__devat","JSON","parse","setItem","stringify","role"],"mappings":"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","sourcesContent":["import { createContext, useReducer, useEffect } from 'react'\r\nimport reducers from './Reducers'\r\nimport { getData } from '../utils/fetchData'\r\n\r\n\r\nexport const DataContext = createContext()\r\n\r\n\r\nexport const DataProvider = ({children}) => {\r\n    const initialState = { \r\n        notify: {}, auth: {}, cart: [], modal: [], orders: [], users: [], categories: []\r\n    }\r\n\r\n    const [state, dispatch] = useReducer(reducers, initialState)\r\n    const { cart, auth } = state\r\n\r\n    useEffect(() => {\r\n        const firstLogin = localStorage.getItem(\"firstLogin\");\r\n        if(firstLogin){\r\n            getData('auth/accessToken').then(res => {\r\n                if(res.err) return localStorage.removeItem(\"firstLogin\")\r\n                dispatch({ \r\n                    type: \"AUTH\",\r\n                    payload: {\r\n                        token: res.access_token,\r\n                        user: res.user\r\n                    }\r\n                })\r\n            })\r\n        }\r\n\r\n        getData('categories').then(res => {\r\n            if(res.err) return dispatch({type: 'NOTIFY', payload: {error: res.err}})\r\n\r\n            dispatch({ \r\n                type: \"ADD_CATEGORIES\",\r\n                payload: res.categories\r\n            })\r\n        })\r\n        \r\n    },[])\r\n\r\n    useEffect(() => {\r\n        const __next__cart01__devat = JSON.parse(localStorage.getItem('__next__cart01__devat'))\r\n\r\n        if(__next__cart01__devat) dispatch({ type: 'ADD_CART', payload: __next__cart01__devat })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('__next__cart01__devat', JSON.stringify(cart))\r\n    }, [cart])\r\n\r\n    useEffect(() => {\r\n        if(auth.token){\r\n            getData('order', auth.token)\r\n            .then(res => {\r\n                if(res.err) return dispatch({type: 'NOTIFY', payload: {error: res.err}})\r\n                \r\n                dispatch({type: 'ADD_ORDERS', payload: res.orders})\r\n            })\r\n\r\n            if(auth.user.role === 'admin'){\r\n                getData('user', auth.token)\r\n                .then(res => {\r\n                    if(res.err) return dispatch({type: 'NOTIFY', payload: {error: res.err}})\r\n                \r\n                    dispatch({type: 'ADD_USERS', payload: res.users})\r\n                })\r\n            }\r\n        }else{\r\n            dispatch({type: 'ADD_ORDERS', payload: []})\r\n            dispatch({type: 'ADD_USERS', payload: []})\r\n        }\r\n    },[auth.token])\r\n\r\n    return(\r\n        <DataContext.Provider value={{state, dispatch}}>\r\n            {children}\r\n        </DataContext.Provider>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}